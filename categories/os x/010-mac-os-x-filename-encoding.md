Mac OS X Filename Encoding
2011-01-24 02:46

OS X 는 파일 이름을 UTF8 로 저장한다.
단, 우리가 일반적으로 사용하고 일는 NFC 방식이 아니라 NFD 방식으로 저장한다.

NFC 는 자소가 합해진 상태로 한 글자에 유니코드 한 단위가 지정되는 것. (일반적인 UTF8 사용법)
NFD 는 한 글자를 각 자소로 분할해서 자소를 나타내는 여러 유니코드 문자의 연속으로 표시하는 것.

이것 때문에 머리 아파지는데,
OS X 파일 시스템에 NFC 파일명을 던지면 NFD 로 자동 변환하지만,
OS X 파일 시스템에서 UTF8 파일명을 받으면 NFD 가 리턴된다고 한다.
'가나다' 가 NFC 에서는 유니코드 3 문자지만, NFD 에서는 초성, 중성이 다 나뉘어져서 6 문자가 된다.

NFD 를 NFC 로 바꿀 수는 있는데, 이걸 처리하지 않는 프로그램에서는 화일명이 달라지는 부작용이 발생한다.
특히 Mac 용 FTP 프로그램으로 한글명 파일을 외부로 전달하면
눈으로 보기에는 같으나 헥스 덤프해보면 파일이름이 2~3 배 길어진 것을 볼 수 있다.

<https://bugzilla.mozilla.org/show_bug.cgi?id=227547>